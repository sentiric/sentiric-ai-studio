# ==============================================================================
# üåç GLOBAL AYARLAR
# ==============================================================================
ENV="development"
LOG_LEVEL="INFO"
ENV_FILE_PATH=.env

CONFIG_REPO_PATH=../sentiric-config
CERTIFICATES_REPO_PATH=../sentiric-certificates
ASSETS_REPO_PATH=../sentiric-assets

# ==============================================================================
# üÜî PROJE Kƒ∞MLƒ∞ƒûƒ∞ VE Aƒû
# ==============================================================================
PROJECT_NAME="sentiric"
PROJECT_TLD="cloud"

# Network (Docker Compose i√ßin)
NETWORK_NAME="sentiric.cloud"
NETWORK_SUBNET=10.88.0.0/16
NETWORK_GATEWAY=10.88.0.1

# Discovery Service (DNS)
DISCOVERY_DATACENTER_NAME="${PROJECT_NAME}-main"
DISCOVERY_DOMAIN="${PROJECT_NAME}.${PROJECT_TLD}"
DISCOVERY_SERVICE_SUBDOMAIN="service"
DISCOVERY_DNS_SEARCH_DOMAIN="${DISCOVERY_SERVICE_SUBDOMAIN}.${DISCOVERY_DOMAIN}"
DISCOVERY_METHOD="DNS"
DISCOVERY_SERVICE_IPV4_ADDRESS=10.88.5.1

# ==============================================================================
# üèóÔ∏è ALTYAPI (INFRASTRUCTURE)
# ==============================================================================
# --- PostgreSQL ---
POSTGRES_HOST=postgres
POSTGRES_IPV4_ADDRESS=10.88.10.1
POSTGRES_DB_PORT=5432
POSTGRES_USER=sentiric
POSTGRES_PASSWORD=sentiric_pass
POSTGRES_DB=sentiric_db
POSTGRES_DB_PARAMETERS="sslmode=disable"
POSTGRES_URL="postgres://${POSTGRES_USER}:${POSTGRES_PASSWORD}@${POSTGRES_HOST}:${POSTGRES_DB_PORT}/${POSTGRES_DB}?sslmode=disable"

# --- Qdrant (Vector DB) ---
QDRANT_HOST=qdrant
QDRANT_IPV4_ADDRESS=10.88.10.4
QDRANT_HTTP_PORT=6333
QDRANT_GRPC_PORT=6334
QDRANT_HTTP_URL="http://${QDRANT_HOST}:${QDRANT_HTTP_PORT}"
QDRANT_GRPC_URL="${QDRANT_HOST}:${QDRANT_GRPC_PORT}"

# --- RAG Ayarlarƒ± ---
QDRANT_DB_COLLECTION_PREFIX="sentiric_kb_"
QDRANT_DB_EMBEDDING_MODEL_NAME="sentence-transformers/paraphrase-multilingual-mpnet-base-v2"

# ==============================================================================
# üß† LLM SERVICE (Metin √úretim) - DENGELƒ∞ PROFƒ∞L
# ==============================================================================
LLM_LLAMA_SERVICE_HOST=llm-llama-service
LLM_LLAMA_SERVICE_IPV4_ADDRESS=10.88.60.7
LLM_LLAMA_SERVICE_HTTP_PORT=16070
LLM_LLAMA_SERVICE_GRPC_PORT=16071
LLM_LLAMA_SERVICE_METRICS_PORT=16072
LLM_LLAMA_SERVICE_LOG_LEVEL=info
LLM_LLAMA_SERVICE_LISTEN_ADDRESS=0.0.0.0

# --- Model Se√ßimi
LLM_LLAMA_SERVICE_MODEL_DIR=/models
# Product Ready
# LLM_LLAMA_SERVICE_MODEL_ID=ggml-org/gemma-3-4b-it-GGUF
# LLM_LLAMA_SERVICE_MODEL_FILENAME=gemma-3-4b-it-Q4_K_M.gguf

# Ba≈üarƒ±lƒ± ba≈üka model
LLM_LLAMA_SERVICE_MODEL_ID=ggml-org/gemma-3-4b-it-qat-GGUF
LLM_LLAMA_SERVICE_MODEL_FILENAME=gemma-3-4b-it-qat-Q4_0.gguf

# Performans i√ßin daha d√º≈ü√ºk bir model tercih edilebilir
# LLM_LLAMA_SERVICE_MODEL_ID=Qwen/Qwen2.5-3B-Instruct-GGUF
#LLM_LLAMA_SERVICE_MODEL_FILENAME=qwen2.5-3b-instruct-q4_k_m.gguf

# Test i√ßin Daha d√º≈ü√ºk model tercih edilebilir.
# LLM_LLAMA_SERVICE_MODEL_ID=ggml-org/gemma-3-1b-it-GGUF
# LLM_LLAMA_SERVICE_MODEL_FILENAME=gemma-3-1b-it-Q4_K_M.gguf
# # LLM_LLAMA_SERVICE_MODEL_FILENAME=gemma-3-1b-it-Q8_0.gguf

# --- GPU Ayarlarƒ± ---
# Modelin tamamƒ±nƒ± GPU'ya y√ºkle. Bu model VRAM'de ~2.5GB yer kaplar.
LLM_LLAMA_SERVICE_GPU_LAYERS=100
# 8192 context ~1.5GB VRAM kullanƒ±r. Toplam VRAM: ~4.0GB.
LLM_LLAMA_SERVICE_CONTEXT_SIZE=8192
LLM_LLAMA_SERVICE_KV_OFFLOAD=true
LLM_LLAMA_SERVICE_THREADS=1
LLM_LLAMA_SERVICE_THREADS_BATCH=1
LLM_LLAMA_SERVICE_USE_MMAP=false
LLM_LLAMA_SERVICE_NUMA=disabled

# --- Advanced √ñzellikler ---
LLM_LLAMA_SERVICE_ENABLE_BATCHING=false
LLM_LLAMA_SERVICE_MAX_BATCH_SIZE=1
LLM_LLAMA_SERVICE_BATCH_TIMEOUT_MS=10
LLM_LLAMA_SERVICE_ENABLE_WARM_UP=false

# --- VoIP ƒ∞√ßin Kritik Sampling Ayarlarƒ± ---
LLM_LLAMA_SERVICE_DEFAULT_TEMPERATURE=0.2
LLM_LLAMA_SERVICE_DEFAULT_TOP_K=40
LLM_LLAMA_SERVICE_DEFAULT_TOP_P=0.9
LLM_LLAMA_SERVICE_DEFAULT_REPEAT_PENALTY=1.15

# --- G√ºvenlik ---
NVIDIA_VISIBLE_DEVICES=all
GRPC_TLS_CA_PATH=/sentiric-certificates/certs/ca.crt
LLM_LLAMA_SERVICE_CERT_PATH=/sentiric-certificates/certs/llm-llama-service-chain.crt
LLM_LLAMA_SERVICE_KEY_PATH=/sentiric-certificates/certs/llm-llama-service.key

# ==============================================================================
# üó£Ô∏è TTS SERVICE KONFƒ∞G√úRASYONU (COQUI XTTS v2)
# ==============================================================================

# --- Servis Adresleme ---
TTS_COQUI_SERVICE_HOST=tts-coqui-service
TTS_COQUI_SERVICE_IPV4_ADDRESS=10.88.40.3
TTS_COQUI_SERVICE_HTTP_PORT=14030
TTS_COQUI_SERVICE_GRPC_PORT=14031
TTS_COQUI_SERVICE_METRICS_PORT=14032

# --- Model ve Lisans ---
TTS_COQUI_SERVICE_MODEL_NAME="tts_models/multilingual/multi-dataset/xtts_v2"
# Coqui CPML Lisans Kabul√º
TTS_COQUI_SERVICE_TOS_AGREED=1

# --- ‚ö° PERFORMANS & DONANIM (6GB VRAM OPTƒ∞Mƒ∞ZASYONU) ---
# Cihaz Se√ßimi: 'cuda' (Nvidia GPU) veya 'cpu'
TTS_COQUI_SERVICE_DEVICE=cuda

# [KRƒ∞Tƒ∞K] D√º≈ü√ºk Kaynak Modu: Modeli par√ßalƒ± y√ºkler ve agresif GC yapar.
# 6GB VRAM i√ßin MUTLAKA 'true' olmalƒ±.
TTS_COQUI_SERVICE_LOW_RESOURCE_MODE=true

# [KRƒ∞Tƒ∞K] Half Precision (FP16): VRAM kullanƒ±mƒ±nƒ± yarƒ± yarƒ±ya d√º≈ü√ºr√ºr, hƒ±zƒ± artƒ±rƒ±r.
TTS_COQUI_SERVICE_ENABLE_HALF_PRECISION=true

# [KRƒ∞Tƒ∞K] CPU Offloading: Attention katmanlarƒ±nƒ± RAM'e ta≈üƒ±r. VRAM'den tasarruf saƒülar.
TTS_COQUI_SERVICE_ENABLE_ATTENTION_KV_CPU_OFFLOAD=true

# DeepSpeed: Linux native ortamda hƒ±z artƒ±rƒ±r ama Docker'da karma≈üƒ±klƒ±k yaratabilir.
# Stabilite i√ßin ≈üimdilik kapalƒ±.
TTS_COQUI_SERVICE_ENABLE_DEEPSPEED=false

# Streaming: D√º≈ü√ºk gecikme i√ßin par√ßalƒ± g√∂nderim (true/false)
TTS_COQUI_SERVICE_ENABLE_STREAMING=false

# PyTorch Bellek Y√∂netimi (Bu deƒüi≈ükenin adƒ± standarttƒ±r, √∂n ek almaz)
# VRAM par√ßalanmasƒ±nƒ± √∂nler (Fragmentation Fix)
PYTORCH_CUDA_ALLOC_CONF=max_split_size_mb:64

# --- Debug ve Loglama ---
# true: Renkli ve detaylƒ± loglar (Geli≈ütirme)
# false: JSON formatƒ±nda loglar (Prod√ºksiyon/Governance)
TTS_COQUI_SERVICE_DEBUG=true

# --- G√ºvenlik / Sertifikalar ---
TTS_COQUI_SERVICE_CERT_PATH=/sentiric-certificates/certs/tts-coqui-service-chain.crt
TTS_COQUI_SERVICE_KEY_PATH=/sentiric-certificates/certs/tts-coqui-service.key

# ==============================================================================
# üëÇ STT SERVICE (WHISPER - SES TANIMA)
# ==============================================================================
STT_WHISPER_SERVICE_HOST=stt-whisper-service
STT_WHISPER_SERVICE_IPV4_ADDRESS=10.88.50.3
STT_WHISPER_SERVICE_HTTP_PORT=15030
STT_WHISPER_SERVICE_GRPC_PORT=15031
STT_WHISPER_SERVICE_METRICS_PORT=15032
STT_WHISPER_SERVICE_LISTEN_ADDRESS=0.0.0.0
STT_WHISPER_SERVICE_LOG_LEVEL=info

# --- Model Se√ßimi (Hƒ±zlƒ± ve Kaliteli) ---
STT_WHISPER_SERVICE_MODEL_DIR=/models
# Product Ready
# STT_WHISPER_SERVICE_MODEL_FILENAME=ggml-large-v3-turbo-q8_0.bin

# Performans i√ßin daha d√º≈ü√ºk bir model tercih edilebilir
STT_WHISPER_SERVICE_MODEL_FILENAME=ggml-large-v3-turbo-q5_0.bin

# Test i√ßin kullanƒ±labilir.
# STT_WHISPER_SERVICE_MODEL_FILENAME=ggml-medium-q5_0.bin

# Vad i√ßin gerekli
STT_WHISPER_SERVICE_VAD_MODEL=ggml-silero-vad.bin

# --- Donanƒ±m Ayarlarƒ± (GPU Modu - ~1.0GB VRAM Kullanƒ±r) ---
STT_WHISPER_SERVICE_DEVICE=cuda
STT_WHISPER_SERVICE_COMPUTE_TYPE=float16
STT_WHISPER_SERVICE_THREADS=1
STT_WHISPER_SERVICE_PARALLEL_REQUESTS=1

# --- √ñzellikler ---
STT_WHISPER_SERVICE_LANGUAGE=auto
STT_WHISPER_SERVICE_ENABLE_DIARIZATION=true
STT_WHISPER_SERVICE_ENABLE_VAD=true
STT_WHISPER_SERVICE_FLASH_ATTN=true

# ==============================================================================
# üìö KNOWLEDGE SERVICES (RAG)
# ==============================================================================
# --- Indexing Service ---
KNOWLEDGE_INDEXING_SERVICE_HOST=knowledge-indexing-service
KNOWLEDGE_INDEXING_SERVICE_IPV4_ADDRESS=10.88.70.3
KNOWLEDGE_INDEXING_SERVICE_HTTP_PORT=17030
KNOWLEDGE_INDEXING_SERVICE_GRPC_PORT=17031
KNOWLEDGE_INDEXING_SERVICE_METRICS_PORT=17032
KNOWLEDGE_INDEXING_INTERVAL_SECONDS=3600
KNOWLEDGE_INDEXING_SERVICE_CERT_PATH=/sentiric-certificates/certs/knowledge-indexing-service-chain.crt
KNOWLEDGE_INDEXING_SERVICE_KEY_PATH=/sentiric-certificates/certs/knowledge-indexing-service.key

# --- Query Service ---
KNOWLEDGE_QUERY_SERVICE_HOST=knowledge-query-service
KNOWLEDGE_QUERY_SERVICE_IPV4_ADDRESS=10.88.70.2
KNOWLEDGE_QUERY_SERVICE_HTTP_PORT=17020
KNOWLEDGE_QUERY_SERVICE_GRPC_PORT=17021
KNOWLEDGE_QUERY_SERVICE_METRICS_PORT=17022
KNOWLEDGE_QUERY_DEFAULT_TOP_K=5
KNOWLEDGE_QUERY_SERVICE_CERT_PATH=/sentiric-certificates/certs/knowledge-query-service-chain.crt
KNOWLEDGE_QUERY_SERVICE_KEY_PATH=/sentiric-certificates/certs/knowledge-query-service.key